
                    ' Begin Worksheet Variables'
                    Dim ws As Worksheet
                    Dim starting_ws As Worksheet
                    Set starting_ws = ActiveSheet
    
For Each ws In ThisWorkbook.Worksheets
                    ws.Activate
        
                    
                    'Define variables'
        
                    Dim Ticker As String
                    Dim Open_Price As Double
                    Dim Close_Price As Double
                    Dim Yearly_Change As Double
                    Dim Percent_Change As Double
                    Dim Total_Stock_Volume As Long
                    Dim Counting As Double
                    Counting = 2
					On Error Resume Next
                
                    'Headers for the Summary Table'
        
                    Range("I1") = "Ticker"
                    Range("J1") = "Yearly Change"
                    Range("K1") = "Percent Change"
                    Range("L1") = "Total Stock Volume"
                          
                    'Finding the last row'
                    LastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row
                  
                        For i = 2 To LastRow
                
                            'Identify when Ticker Symbol Changes'
                
                            If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then
                    
                                'Defining calculations'
                    
                                Cells(Counting, 9).Value = Cells(i, 1)
                                Ticker = Cells(Counting, 9).Value
                                Open_Price = Cells(i, 3).Value
                                Close_Price = Cells(i, 6).Value
                                Yearly_Change = Close_Price - Open_Price
                                Cells(Counting, 10).Value = Yearly_Change
                                Percent_Change = (Close_Price / Open_Price) - 1
                                Cells(Counting, 11).Value = FormatPercent(Percent_Change, 2)
                                Total_Stock_Volume = Total_Stock_Volume + Cells(i, 7).Value
                                Cells(Counting, 12).Value = Total_Stock_Volume
                                Counting = Counting + 1
                    
                                    'Conditional formatting'
                        
                                    If Yearly_Change >= 0 Then
                                        Cells(Counting - 1, 10).Interior.ColorIndex = 4
                                    ElseIf Yearly_Change < 0 Then
                                        Cells(Counting - 1, 10).Interior.ColorIndex = 3
                                    End If   
                               
                            End If
              
                    
                        Next i

   
   Next ws
   
        starting_ws.Activate

End Sub


